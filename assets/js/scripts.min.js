/*!
 * gulp-nunjucks-sass-template
 * A Gulp 4 template including SCSS, Nunjucks, JS and more
 *
 * Url: https://github.com/DefaultSimon
 * Author: Simon GoriÄar
 * Copyright 2022. License: MIT
 */
window.onload=function(){const e=document.querySelectorAll(".section");let t=document.querySelectorAll(".section--variants .variant"),n=!1;const o=new IntersectionObserver(function(e,t){e.forEach(e=>{e.isIntersecting?(e.target.classList.remove("animate-off"),e.target.classList.add("animate")):(e.target.classList.remove("animate"),e.target.classList.add("animate-off"))})},{root:null,rootMargin:"10%",threshold:.5});function s(e,t,o,s){console.log(e,t),n=!0;let a=null,i=window.pageYOffset||document.documentElement.scrollTop,r=window.innerHeight,c=0,l=0;c="center"===s?t?(r+e.offsetHeight)/2:e.parentElement.getBoundingClientRect().top+(r+e.offsetHeight)/2:"bottom"===s?e.parentElement.getBoundingClientRect().bottom-r:e.getBoundingClientRect().top,function(){const e=["ms","moz","webkit","o"];for(let t=0,n=e.length;t<n&&!window.requestAnimationFrame;t++)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"]}(),window.requestAnimationFrame(function s(d){a||(a=d||(new Date).getTime());let m=(d-a)/+o;m=+m.toFixed(2);let u=+(f=m,f*(2-f)).toFixed(2);var f;l=+(l=i+c*u).toFixed(2),window.scrollTo(0,l),console.log(isNaN(l),l<0,!t&&l<=0,!t&&l<=i+c+1,t&&l>=i+c,t&&document.body.getBoundingClientRect().bottom-1<r,t&&e.getBoundingClientRect().top.toFixed(0)-1>=0&&e.innerHeight<=r,e.getBoundingClientRect().top.toFixed(0)+1),isNaN(l)||l<0||!t&&l<=0||!t&&l<=i+c+1||t&&l>=i+c||t&&document.body.getBoundingClientRect().bottom-1<r||t&&e.getBoundingClientRect().top.toFixed(0)-1<=0&&e.innerHeight<=r?(cancelAnimationFrame(a),e&&e.focus(),setTimeout(()=>{n=!1},300)):window.requestAnimationFrame(s)})}function a(e,t,o){n=!0,!o&&t.offsetHeight<window.innerHeight||(e.classList.add("animate-fade"),t.classList.remove("animate-fade")),setTimeout(()=>n=!1,300)}function i(o,i){if(o.preventDefault(),!n){let r,c=Array.from(e).findIndex(e=>e.classList.contains("animate")),l=i||o.deltaY>0;if(r=l?c+1<e.length?Array.from(e)[c+1]:Array.from(e)[c]:c>0?Array.from(e)[c-1]:Array.from(e)[0],console.log(c,e.length,e[c].getBoundingClientRect().top,l,i),e[c].classList.contains("section--variants"))l&&t[t.length-1].classList.contains("variant--current")||!l&&t[0].classList.contains("variant--current")?new s(r,l,600):(e[c].scrollIntoView({behavior:"auto"}),new function(e,t,o){n=!0;let s=e.querySelector(".section__variants").getBoundingClientRect().top,a=e.querySelector("ul"),i=e.querySelector(".variant--current"),r=o?Array.from(t).findIndex(e=>e.classList.contains("variant--current"))+1:Array.from(t).findIndex(e=>e.classList.contains("variant--current"))-1,c=Array.from(t)[r].getBoundingClientRect().top,l=0;if(a.style.transform){let e=window.getComputedStyle(a);l=new DOMMatrixReadOnly(e.transform).m42}i.classList.remove("variant--current"),Array.from(t)[r].classList.add("variant--current"),a.style.transform=`translateY(${s-c+l}px)`,setTimeout(()=>n=!1,300)}(document.querySelector(".section--variants"),t,l));else if(e[c].classList.contains("section--world")){let t=document.querySelectorAll(".section--world .section__slide");l&&t[t.length-1].classList.contains("show")||!l&&t[0].classList.contains("show")?new s(r,l,600):(e[c].scrollIntoView({behavior:"auto"}),new function(e,t,o){n=!0;let s=Array.from(t).findIndex(e=>e.classList.contains("show")),a=o?s+1:s-1;Array.from(t)[s].classList.remove("show"),Array.from(t)[a].classList.add("show"),e.setAttribute("data-slide",+a),setTimeout(()=>n=!1,400)}(e[c],t,l))}else if(e[c].classList.contains("section--roadmap")||r.classList.contains("section--roadmap")&&!l||r.classList.contains("section--opportunities")&&!l){let t=document.querySelector(".section--roadmap .expertise");t.classList.contains("animate-off")?l?(new a(e[c].querySelector(".section__content"),t,l),new s(t,l,900,"bottom"),t.classList.remove("animate-off")):(r.querySelector(".community").classList.remove("animate-fade"),new s(r.querySelector(".community"),l,900,"center")):t.classList.contains("animate-fade")?(t.classList.remove("animate-fade"),r.querySelector(".section__content").classList.add("animate-fade"),new s(t,l,900,"bottom")):l?(t.classList.add("animate-fade"),new s(r,l,600)):(new s(e[c],l,600),t.classList.add("animate-off"),e[c].querySelector(".section__content").classList.remove("animate-fade"))}else if(e[c].classList.contains("section--opportunities")||r.classList.contains("section--opportunities")&&!l||r.classList.contains("section--backstory")&&!l){let t=document.querySelector(".section--opportunities .community");t.classList.contains("animate-off")?l?(t.classList.remove("animate-off"),new a(e[c].querySelector(".section__content"),t,l),new s(t,l,900,"center")):(r.querySelector(".place").classList.remove("animate-fade"),new s(r.querySelector(".place"),l,900,"center")):t.classList.contains("animate-fade")?(t.classList.remove("animate-fade"),r.querySelector(".section__content").classList.add("animate-fade"),new s(t,l,900,"center")):l?(new s(r,l,600),t.classList.add("animate-fade")):(new s(e[c],l,600),t.classList.add("animate-off"),e[c].querySelector(".section__content").classList.remove("animate-fade"))}else if(e[c].classList.contains("section--backstory")||r.classList.contains("section--backstory")&&!l||r.classList.contains("section--world")&&!l){let t=document.querySelector(".section--backstory .place");t.classList.contains("animate-off")?l?(t.classList.remove("animate-off"),new a(e[c].querySelector(".section__content"),t,l),new s(t,l,900,"center")):(e[c].classList.remove("animate-off"),new s(r,l,600)):t.classList.contains("animate-fade")?(t.classList.remove("animate-fade"),r.querySelector(".section__content").classList.add("animate-fade"),new s(t,l,900,"center")):l?(new s(r,l,600),t.classList.add("animate-fade")):(new s(e[c],l,600),t.classList.add("animate-off"),e[c].querySelector(".section__content").classList.remove("animate-fade"))}else e[c].classList.contains("footer")&&r.classList.contains("footer")?(console.log("footer"),l?new s(r,l,600,"bottom"):new s(r,l,600)):(console.log(r),new s(r,l,600))}}let r;function c(e){let t=window.innerWidth/2,n=window.innerHeight/2,o=e.clientX,s=e.clientY;this.querySelectorAll(".parallaxed").forEach((e,a)=>{let i=-.001*a-.001;e.style.marginLeft=`${(o-t)*i}%`,e.style.marginTop=`${(s-n)*i}%`})}e.forEach(e=>o.observe(e)),window.addEventListener("wheel",i,{passive:!1}),window.addEventListener("mousewheel",i,{passive:!1}),window.addEventListener("DOMMouseScroll",i,{passive:!1}),window.addEventListener("touchstart",e=>{r=e.touches[0].screenY},{passive:!1}),window.addEventListener("touchmove",e=>{let t=r-e.touches[0].screenY;console.log(t),t>=50&&(e.preventDefault(),new i(e,t>0)),t<=-50?(e.preventDefault(),new i(e,t>0)):e.preventDefault()},{passive:!1}),document.querySelectorAll(".parallax").forEach(e=>{e.addEventListener("mousemove",c)}),new Splide(".road",{perPage:3,perMove:1,breakpoints:{920:{perPage:2},520:{perPage:1}}}).mount(),new Splide(".section__articles",{perPage:3,perMove:1,gap:"32px",breakpoints:{640:{gap:"16px",perPage:2},520:{gap:"16px",perPage:1}}}).mount(),new Splide(".section__opportunities",{perPage:4,perMove:1,gap:"32px",breakpoints:{920:{perPage:2},640:{perPage:1}}}).mount()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwic2VjdGlvbnMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ2YXJpYW50cyIsImlzU2Nyb2xsaW5nIiwib2JzZXJ2ZXIiLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsImVudHJpZXMiLCJmb3JFYWNoIiwiZW50cnkiLCJpc0ludGVyc2VjdGluZyIsInRhcmdldCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsInJvb3QiLCJyb290TWFyZ2luIiwidGhyZXNob2xkIiwiU2Nyb2xsIiwiZWxlbWVudCIsImlzRG93biIsInNwZWVkIiwidHlwZSIsImNvbnNvbGUiLCJsb2ciLCJzdGFydCIsImZpcnN0UG9zIiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxUb3AiLCJ3aW5kb3dIZWlnaHQiLCJpbm5lckhlaWdodCIsInBvcyIsIm9mZnNldEhlaWdodCIsInBhcmVudEVsZW1lbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJib3R0b20iLCJicm93c2VyIiwieCIsImxlbmd0aCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwic2hvd0FuaW1hdGlvbiIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwicHJvZ3Jlc3MiLCJ0b0ZpeGVkIiwiZWFzZUluUGVyY2VudGFnZSIsIm4iLCJzY3JvbGxUbyIsImlzTmFOIiwiYm9keSIsImZvY3VzIiwic2V0VGltZW91dCIsIkFuaW1hdGVGYWRlIiwiY3VycmVudCIsImlkRG93biIsIldoZWVsIiwiZSIsIkRvd24iLCJwcmV2ZW50RGVmYXVsdCIsIkFycmF5IiwiZnJvbSIsImZpbmRJbmRleCIsInNlY3Rpb24iLCJjb250YWlucyIsImRlbHRhWSIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJjb250YWluZXIiLCJlbGVtZW50cyIsImNvbnRhaW5lclRvcCIsInF1ZXJ5U2VsZWN0b3IiLCJwYXJlbnQiLCJ0YXJnZXRJbmRleCIsImVsIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJnZXRDb21wdXRlZFN0eWxlIiwiRE9NTWF0cml4UmVhZE9ubHkiLCJtNDIiLCJzbGlkZXMiLCJzZXRBdHRyaWJ1dGUiLCJleHBlcnRpc2UiLCJjb21tdW5pdHkiLCJwbGFjZSIsInRvdWNoWSIsIlBhcmFsbGF4IiwiX3ciLCJpbm5lcldpZHRoIiwiX2giLCJfbW91c2VYIiwiY2xpZW50WCIsIl9tb3VzZVkiLCJjbGllbnRZIiwidGhpcyIsImluZGV4IiwibXVsdGlwbHkiLCJtYXJnaW5MZWZ0IiwibWFyZ2luVG9wIiwib2JzZXJ2ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXNzaXZlIiwidG91Y2hlcyIsInNjcmVlblkiLCJwYXJhbGxheCIsIlNwbGlkZSIsInBlclBhZ2UiLCJwZXJNb3ZlIiwiYnJlYWtwb2ludHMiLCI5MjAiLCI1MjAiLCJtb3VudCIsImdhcCIsIjY0MCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQUEsT0FBQUMsT0FBQSxXQUNBLE1BQUFDLEVBQUFDLFNBQUFDLGlCQUFBLFlBQ0EsSUFBQUMsRUFBQUYsU0FBQUMsaUJBQUEsK0JBRUFFLEdBQUEsRUFnQkEsTUFBQUMsRUFBQSxJQUFBQyxxQkFkQSxTQUFBQyxFQUFBRixHQUNBRSxFQUFBQyxRQUFBQyxJQUNBQSxFQUFBQyxnQkFFQUQsRUFBQUUsT0FBQUMsVUFBQUMsT0FBQSxlQUNBSixFQUFBRSxPQUFBQyxVQUFBRSxJQUFBLGFBR0FMLEVBQUFFLE9BQUFDLFVBQUFDLE9BQUEsV0FDQUosRUFBQUUsT0FBQUMsVUFBQUUsSUFBQSxvQkFkQUMsS0FBQSxLQUNBQyxXQUFBLE1BQ0FDLFVBQUEsS0FxQkEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsUUFBQUMsSUFBQUwsRUFBQUMsR0FDQWhCLEdBQUEsRUFDQSxJQUFBcUIsRUFBQSxLQUNBQyxFQUFBNUIsT0FBQTZCLGFBQUExQixTQUFBMkIs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QSxPQUNBSixhQUNBQyxLQUNBSCxRQUFBLEdBRUFPLEtBQ0FQLFFBQUEsTUFJQUsiLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICBjb25zdCBzZWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uJyk7XG4gIGxldCB2YXJpYW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uLS12YXJpYW50cyAudmFyaWFudCcpO1xuXG4gIGxldCBpc1Njcm9sbGluZyA9IGZhbHNlO1xuICBsZXQgbGFzdFNjcm9sbFRvcCA9IDA7XG4gIGxldCBpc0Rvd24gPSB0cnVlO1xuXG4gIGNvbnN0IG9ic2VydmVyT3B0aW9ucyA9IHtcbiAgICByb290OiBudWxsLFxuICAgIHJvb3RNYXJnaW46ICcxMCUnLFxuICAgIHRocmVzaG9sZDogMC41XG4gIH07XG5cbiAgZnVuY3Rpb24gb2JzZXJ2ZXJDYWxsYmFjayhlbnRyaWVzLCBvYnNlcnZlcikge1xuICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICBpZiAoZW50cnkuaXNJbnRlcnNlY3RpbmcpIHtcbiAgICAgICAgLy8gZmFkZSBpbiBvYnNlcnZlZCBlbGVtZW50cyB0aGF0IGFyZSBpbiB2aWV3XG4gICAgICAgIGVudHJ5LnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLW9mZicpO1xuICAgICAgICBlbnRyeS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZmFkZSBvdXQgb2JzZXJ2ZWQgZWxlbWVudHMgdGhhdCBhcmUgbm90IGluIHZpZXdcbiAgICAgICAgZW50cnkudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2FuaW1hdGUnKTtcbiAgICAgICAgZW50cnkudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtb2ZmJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBvYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihvYnNlcnZlckNhbGxiYWNrLCBvYnNlcnZlck9wdGlvbnMpO1xuXG4gIHNlY3Rpb25zLmZvckVhY2goZWwgPT4gb2JzZXJ2ZXIub2JzZXJ2ZShlbCkpO1xuXG4gIGZ1bmN0aW9uIFNjcm9sbChlbGVtZW50LCBpc0Rvd24sIHNwZWVkLCB0eXBlKSB7XG4gICAgY29uc29sZS5sb2coZWxlbWVudCwgaXNEb3duKTtcbiAgICBpc1Njcm9sbGluZyA9IHRydWU7XG4gICAgbGV0IHN0YXJ0ID0gbnVsbDtcbiAgICBsZXQgZmlyc3RQb3MgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICBsZXQgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIGxldCB0YXJnZXQgPSAwO1xuICAgIGxldCBwb3MgPSAwO1xuXG4gICAgaWYgKHR5cGUgPT09ICdjZW50ZXInKSB7XG4gICAgICB0YXJnZXQgPSBpc0Rvd24gPyAod2luZG93SGVpZ2h0ICsgZWxlbWVudC5vZmZzZXRIZWlnaHQpIC8gMiA6IGVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyAod2luZG93SGVpZ2h0ICsgZWxlbWVudC5vZmZzZXRIZWlnaHQpIC8gMjtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdib3R0b20nKSB7XG4gICAgICB0YXJnZXQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tIC0gd2luZG93SGVpZ2h0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0YXJnZXQgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgICB9XG5cbiAgICAvLyBjb25zb2xlLmxvZyhmaXJzdFBvcywgdGFyZ2V0LCBwb3MsIGVsZW1lbnQpO1xuXG4gICAgKGZ1bmN0aW9uKCkge1xuXG4gICAgICBjb25zdCBicm93c2VyID0gWydtcycsICdtb3onLCAnd2Via2l0JywgJ28nXTtcblxuICAgICAgZm9yKGxldCB4ID0gMCwgbGVuZ3RoID0gYnJvd3Nlci5sZW5ndGg7IHggPCBsZW5ndGggJiYgIXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7IHgrKykge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gd2luZG93W2Jyb3dzZXJbeF0rJ1JlcXVlc3RBbmltYXRpb25GcmFtZSddO1xuICAgICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSB3aW5kb3dbYnJvd3Nlclt4XSsnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnXSB8fCB3aW5kb3dbYnJvd3Nlclt4XSsnQ2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lJ107XG4gICAgICB9XG5cbiAgICB9KCkpO1xuXG4gICAgZnVuY3Rpb24gc2hvd0FuaW1hdGlvbiAodGltZXN0YW1wKSB7XG5cbiAgICAgIGlmKCFzdGFydCkgeyBzdGFydCA9IHRpbWVzdGFtcCB8fCBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfSAvL2dldCBpZCBvZiBhbmltYXRpb25cblxuICAgICAgbGV0IGVsYXBzZWQgPSB0aW1lc3RhbXAgLSBzdGFydDtcbiAgICAgIGxldCBwcm9ncmVzcyA9IGVsYXBzZWQgLyArc3BlZWQ7IC8vIGFuaW1hdGlvbiBkdXJhdGlvbiA1MDBtc1xuICAgICAgcHJvZ3Jlc3MgPSArcHJvZ3Jlc3MudG9GaXhlZCgyKTtcblxuICAgICAgLy8gY29uc29sZS5sb2coc3RhcnQsIHRpbWVzdGFtcCwgcHJvZ3Jlc3MsIGVsYXBzZWQsIHNwZWVkLCBmaXJzdFBvcywgdGFyZ2V0LCBwb3MpO1xuXG4gICAgICAvL2Vhc2UgaW4gZnVuY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vY29tcG9uZW50L2Vhc2UvYmxvYi9tYXN0ZXIvaW5kZXguanNcbiAgICAgIGNvbnN0IG91dFF1YWQgPSBmdW5jdGlvbihuKXtcbiAgICAgICAgcmV0dXJuIG4gKiAoMiAtIG4pO1xuICAgICAgfTtcblxuICAgICAgbGV0IGVhc2VJblBlcmNlbnRhZ2UgPSArKG91dFF1YWQocHJvZ3Jlc3MpKS50b0ZpeGVkKDIpO1xuXG4gICAgICBwb3MgPSBmaXJzdFBvcyArICh0YXJnZXQgKiBlYXNlSW5QZXJjZW50YWdlKTtcbiAgICAgIHBvcyA9ICtwb3MudG9GaXhlZCgyKTtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCBwb3MpO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgaXNOYU4ocG9zKSwgcG9zIDwgMCxcbiAgICAgICAgIWlzRG93biAmJiBwb3MgPD0gMCxcbiAgICAgICAgIWlzRG93biAmJiBwb3MgPD0gKGZpcnN0UG9zICsgdGFyZ2V0ICsgMSksXG4gICAgICAgIGlzRG93biAmJiBwb3MgPj0gKGZpcnN0UG9zICsgdGFyZ2V0KSxcbiAgICAgICAgaXNEb3duICYmIGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tIC0gMSA8IHdpbmRvd0hlaWdodCxcbiAgICAgICAgaXNEb3duICYmIChlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcC50b0ZpeGVkKDApIC0gMSA+PSAwICYmIGVsZW1lbnQuaW5uZXJIZWlnaHQgPD0gd2luZG93SGVpZ2h0KSxcbiAgICAgICAgZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AudG9GaXhlZCgwKSArIDFcbiAgICAgICAgKTtcblxuICAgICAgaWYoIGlzTmFOKHBvcykgfHwgcG9zIDwgMCB8fFxuICAgICAgICAhaXNEb3duICYmIHBvcyA8PSAwIHx8XG4gICAgICAgICFpc0Rvd24gJiYgcG9zIDw9IChmaXJzdFBvcyArIHRhcmdldCArIDEpIHx8XG4gICAgICAgIGlzRG93biAmJiBwb3MgPj0gKGZpcnN0UG9zICsgdGFyZ2V0KSB8fFxuICAgICAgICBpc0Rvd24gJiYgZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20gLSAxIDwgd2luZG93SGVpZ2h0IHx8XG4gICAgICAgIGlzRG93biAmJiAoZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AudG9GaXhlZCgwKSAtIDEgPD0gMCAmJiBlbGVtZW50LmlubmVySGVpZ2h0IDw9IHdpbmRvd0hlaWdodClcbiAgICAgICl7XG4gICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHN0YXJ0KTtcbiAgICAgICAgaWYoZWxlbWVudCkge1xuICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KCgpPT4ge1xuICAgICAgICAgIGlzU2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cocG9zLCBpc1Njcm9sbGluZywgZWxlbWVudCk7XG4gICAgICAgIH0sIDMwMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNob3dBbmltYXRpb24pO1xuICAgICAgfVxuICAgIH1cbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNob3dBbmltYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gSW5uZXJTY3JvbGwoY29udGFpbmVyLCBlbGVtZW50cywgaXNEb3duKSB7XG4gICAgaXNTY3JvbGxpbmcgPSB0cnVlO1xuICAgIGxldCBjb250YWluZXJUb3AgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb25fX3ZhcmlhbnRzJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgIGxldCBwYXJlbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcigndWwnKTtcbiAgICBsZXQgY3VycmVudCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcudmFyaWFudC0tY3VycmVudCcpO1xuICAgIGxldCB0YXJnZXRJbmRleCA9IGlzRG93biA/XG4gICAgICBBcnJheS5mcm9tKGVsZW1lbnRzKS5maW5kSW5kZXgoIGVsID0+IGVsLmNsYXNzTGlzdC5jb250YWlucygndmFyaWFudC0tY3VycmVudCcpKSArIDEgOlxuICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZmluZEluZGV4KCBlbCA9PiBlbC5jbGFzc0xpc3QuY29udGFpbnMoJ3ZhcmlhbnQtLWN1cnJlbnQnKSkgLSAxO1xuICAgIGxldCB0YXJnZXQgPSBBcnJheS5mcm9tKGVsZW1lbnRzKVt0YXJnZXRJbmRleF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgIGxldCBwb3MgPSAwO1xuICAgIGlmIChwYXJlbnQuc3R5bGUudHJhbnNmb3JtKSB7XG4gICAgICBsZXQgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnQpO1xuICAgICAgbGV0IG1hdHJpeCA9IG5ldyBET01NYXRyaXhSZWFkT25seShzdHlsZS50cmFuc2Zvcm0pO1xuICAgICAgcG9zID0gbWF0cml4Lm00MjtcbiAgICB9XG4gICAgLy8gY29uc29sZS5sb2coY29udGFpbmVyVG9wLCBwYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wLCB0YXJnZXQsIHBvcyk7XG4gICAgY3VycmVudC5jbGFzc0xpc3QucmVtb3ZlKCd2YXJpYW50LS1jdXJyZW50Jyk7XG4gICAgQXJyYXkuZnJvbShlbGVtZW50cylbdGFyZ2V0SW5kZXhdLmNsYXNzTGlzdC5hZGQoJ3ZhcmlhbnQtLWN1cnJlbnQnKTtcbiAgICBwYXJlbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVkoJHtjb250YWluZXJUb3AgLSB0YXJnZXQgKyBwb3N9cHgpYDtcbiAgICBzZXRUaW1lb3V0KCgpID0+IGlzU2Nyb2xsaW5nID0gZmFsc2UsIDMwMCk7XG4gIH1cblxuICBmdW5jdGlvbiBTbGlkZXNTY3JvbGwoY29udGFpbmVyLCBlbGVtZW50cywgaXNEb3duKSB7XG4gICAgaXNTY3JvbGxpbmcgPSB0cnVlO1xuICAgIGxldCBjdXJyZW50ID0gQXJyYXkuZnJvbShlbGVtZW50cykuZmluZEluZGV4KGVsID0+IGVsLmNsYXNzTGlzdC5jb250YWlucygnc2hvdycpKTtcbiAgICBsZXQgdGFyZ2V0ID0gaXNEb3duID8gY3VycmVudCArIDEgOiBjdXJyZW50IC0gMTtcbiAgICBBcnJheS5mcm9tKGVsZW1lbnRzKVtjdXJyZW50XS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7XG4gICAgQXJyYXkuZnJvbShlbGVtZW50cylbdGFyZ2V0XS5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XG4gICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1zbGlkZScsICt0YXJnZXQpO1xuICAgIHNldFRpbWVvdXQoKCkgPT4gaXNTY3JvbGxpbmcgPSBmYWxzZSwgNDAwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEFuaW1hdGVGYWRlKGN1cnJlbnQsIHRhcmdldCwgaWREb3duKSB7XG4gICAgaXNTY3JvbGxpbmcgPSB0cnVlO1xuICAgIGlmICghKCFpZERvd24gJiYgdGFyZ2V0Lm9mZnNldEhlaWdodCA8IHdpbmRvdy5pbm5lckhlaWdodCkpIHtcbiAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgfVxuICAgIHNldFRpbWVvdXQoKCkgPT4gaXNTY3JvbGxpbmcgPSBmYWxzZSwgMzAwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIFdoZWVsKGUsIERvd24pIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKCFpc1Njcm9sbGluZykge1xuICAgICAgbGV0IGN1cnJlbnQgPSBBcnJheS5mcm9tKHNlY3Rpb25zKS5maW5kSW5kZXgoc2VjdGlvbiA9PiBzZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucygnYW5pbWF0ZScpKTtcbiAgICAgIGxldCBpc0Rvd24gPSBEb3duIHx8IGUuZGVsdGFZID4gMDtcbiAgICAgIGxldCB0YXJnZXQ7XG4gICAgICBpZiAoaXNEb3duKSB7XG4gICAgICAgIHRhcmdldCA9IGN1cnJlbnQgKyAxIDwgc2VjdGlvbnMubGVuZ3RoID8gQXJyYXkuZnJvbShzZWN0aW9ucylbY3VycmVudCArIDFdIDogQXJyYXkuZnJvbShzZWN0aW9ucylbY3VycmVudF07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXQgPSBjdXJyZW50ID4gMCA/IEFycmF5LmZyb20oc2VjdGlvbnMpW2N1cnJlbnQgLSAxXSA6IEFycmF5LmZyb20oc2VjdGlvbnMpWzBdO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coY3VycmVudCwgc2VjdGlvbnMubGVuZ3RoLCBzZWN0aW9uc1tjdXJyZW50XS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AsIGlzRG93biwgRG93bik7XG5cbiAgICAgIGlmIChzZWN0aW9uc1tjdXJyZW50XS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlY3Rpb24tLXZhcmlhbnRzJykpIHtcbiAgICAgICAgaWYgKGlzRG93biAmJiB2YXJpYW50c1t2YXJpYW50cy5sZW5ndGggLSAxXS5jbGFzc0xpc3QuY29udGFpbnMoJ3ZhcmlhbnQtLWN1cnJlbnQnKSB8fFxuICAgICAgICAgICFpc0Rvd24gJiYgdmFyaWFudHNbMF0uY2xhc3NMaXN0LmNvbnRhaW5zKCd2YXJpYW50LS1jdXJyZW50JykpIHtcbiAgICAgICAgICBuZXcgU2Nyb2xsKHRhcmdldCwgaXNEb3duLCA2MDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlY3Rpb25zW2N1cnJlbnRdLnNjcm9sbEludG9WaWV3KHtiZWhhdmlvcjogJ2F1dG8nfSk7XG4gICAgICAgICAgbmV3IElubmVyU2Nyb2xsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLS12YXJpYW50cycpLCB2YXJpYW50cywgaXNEb3duKTtcbiAgICAgICAgfVxuXG4gICAgICB9IGVsc2UgaWYgKHNlY3Rpb25zW2N1cnJlbnRdLmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbi0td29ybGQnKSkge1xuICAgICAgICBsZXQgc2xpZGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24tLXdvcmxkIC5zZWN0aW9uX19zbGlkZScpO1xuICAgICAgICBpZiAoaXNEb3duICYmIHNsaWRlc1tzbGlkZXMubGVuZ3RoIC0gMV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93JykgfHxcbiAgICAgICAgICAhaXNEb3duICYmIHNsaWRlc1swXS5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xuICAgICAgICAgIG5ldyBTY3JvbGwodGFyZ2V0LCBpc0Rvd24sIDYwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VjdGlvbnNbY3VycmVudF0uc2Nyb2xsSW50b1ZpZXcoe2JlaGF2aW9yOiAnYXV0byd9KTtcbiAgICAgICAgICBuZXcgU2xpZGVzU2Nyb2xsKHNlY3Rpb25zW2N1cnJlbnRdLCBzbGlkZXMsIGlzRG93bik7XG4gICAgICAgIH1cblxuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgc2VjdGlvbnNbY3VycmVudF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWN0aW9uLS1yb2FkbWFwJykgfHxcbiAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbi0tcm9hZG1hcCcpICYmICFpc0Rvd24gfHxcbiAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbi0tb3Bwb3J0dW5pdGllcycpICYmICFpc0Rvd25cbiAgICAgICkge1xuICAgICAgICBsZXQgZXhwZXJ0aXNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tLXJvYWRtYXAgLmV4cGVydGlzZScpO1xuICAgICAgICBpZiAoZXhwZXJ0aXNlLmNsYXNzTGlzdC5jb250YWlucygnYW5pbWF0ZS1vZmYnKSkge1xuICAgICAgICAgIGlmIChpc0Rvd24pIHtcbiAgICAgICAgICAgIG5ldyBBbmltYXRlRmFkZShzZWN0aW9uc1tjdXJyZW50XS5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbl9fY29udGVudCcpLCBleHBlcnRpc2UsIGlzRG93bik7XG4gICAgICAgICAgICBuZXcgU2Nyb2xsKGV4cGVydGlzZSwgaXNEb3duLCA5MDAsICdib3R0b20nKTtcbiAgICAgICAgICAgIGV4cGVydGlzZS5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLW9mZicpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQucXVlcnlTZWxlY3RvcignLmNvbW11bml0eScpLmNsYXNzTGlzdC5yZW1vdmUoJ2FuaW1hdGUtZmFkZScpO1xuICAgICAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQucXVlcnlTZWxlY3RvcignLmNvbW11bml0eScpLCBpc0Rvd24sIDkwMCwgJ2NlbnRlcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChleHBlcnRpc2UuY2xhc3NMaXN0LmNvbnRhaW5zKCdhbmltYXRlLWZhZGUnKSkge1xuICAgICAgICAgIGV4cGVydGlzZS5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLWZhZGUnKTtcbiAgICAgICAgICB0YXJnZXQucXVlcnlTZWxlY3RvcignLnNlY3Rpb25fX2NvbnRlbnQnKS5jbGFzc0xpc3QuYWRkKCdhbmltYXRlLWZhZGUnKTtcbiAgICAgICAgICBuZXcgU2Nyb2xsKGV4cGVydGlzZSwgaXNEb3duLCA5MDAsICdib3R0b20nKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoaXNEb3duKSB7XG4gICAgICAgICAgICBleHBlcnRpc2UuY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgICAgICAgICBuZXcgU2Nyb2xsKHRhcmdldCwgaXNEb3duLCA2MDApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgU2Nyb2xsKHNlY3Rpb25zW2N1cnJlbnRdLCBpc0Rvd24sIDYwMCk7XG4gICAgICAgICAgICBleHBlcnRpc2UuY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZS1vZmYnKTtcbiAgICAgICAgICAgIHNlY3Rpb25zW2N1cnJlbnRdLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uX19jb250ZW50JykuY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIHNlY3Rpb25zW2N1cnJlbnRdLmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbi0tb3Bwb3J0dW5pdGllcycpIHx8XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NlY3Rpb24tLW9wcG9ydHVuaXRpZXMnKSAmJiAhaXNEb3duIHx8XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NlY3Rpb24tLWJhY2tzdG9yeScpICYmICFpc0Rvd25cbiAgICAgICkge1xuICAgICAgICBsZXQgY29tbXVuaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tLW9wcG9ydHVuaXRpZXMgLmNvbW11bml0eScpO1xuICAgICAgICBpZiAoY29tbXVuaXR5LmNsYXNzTGlzdC5jb250YWlucygnYW5pbWF0ZS1vZmYnKSkge1xuICAgICAgICAgIGlmIChpc0Rvd24pIHtcbiAgICAgICAgICAgIGNvbW11bml0eS5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLW9mZicpO1xuICAgICAgICAgICAgbmV3IEFuaW1hdGVGYWRlKHNlY3Rpb25zW2N1cnJlbnRdLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uX19jb250ZW50JyksIGNvbW11bml0eSwgaXNEb3duKTtcbiAgICAgICAgICAgIG5ldyBTY3JvbGwoY29tbXVuaXR5LCBpc0Rvd24sIDkwMCwgJ2NlbnRlcicpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQucXVlcnlTZWxlY3RvcignLnBsYWNlJykuY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgICAgICAgICBuZXcgU2Nyb2xsKHRhcmdldC5xdWVyeVNlbGVjdG9yKCcucGxhY2UnKSwgaXNEb3duLCA5MDAsICdjZW50ZXInKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY29tbXVuaXR5LmNsYXNzTGlzdC5jb250YWlucygnYW5pbWF0ZS1mYWRlJykpIHtcbiAgICAgICAgICBjb21tdW5pdHkuY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgICAgICAgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uX19jb250ZW50JykuY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZS1mYWRlJyk7XG4gICAgICAgICAgbmV3IFNjcm9sbChjb21tdW5pdHksIGlzRG93biwgOTAwLCAnY2VudGVyJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGlzRG93bikge1xuICAgICAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQsIGlzRG93biwgNjAwKTtcbiAgICAgICAgICAgIGNvbW11bml0eS5jbGFzc0xpc3QuYWRkKCdhbmltYXRlLWZhZGUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IFNjcm9sbChzZWN0aW9uc1tjdXJyZW50XSwgaXNEb3duLCA2MDApO1xuICAgICAgICAgICAgY29tbXVuaXR5LmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtb2ZmJyk7XG4gICAgICAgICAgICBzZWN0aW9uc1tjdXJyZW50XS5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbl9fY29udGVudCcpLmNsYXNzTGlzdC5yZW1vdmUoJ2FuaW1hdGUtZmFkZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICBzZWN0aW9uc1tjdXJyZW50XS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlY3Rpb24tLWJhY2tzdG9yeScpIHx8XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NlY3Rpb24tLWJhY2tzdG9yeScpICYmICFpc0Rvd24gfHxcbiAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2VjdGlvbi0td29ybGQnKSAmJiAhaXNEb3duXG4gICAgICApIHtcbiAgICAgICAgbGV0IHBsYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tLWJhY2tzdG9yeSAucGxhY2UnKTtcbiAgICAgICAgaWYgKHBsYWNlLmNsYXNzTGlzdC5jb250YWlucygnYW5pbWF0ZS1vZmYnKSkge1xuICAgICAgICAgIGlmIChpc0Rvd24pIHtcbiAgICAgICAgICAgIHBsYWNlLmNsYXNzTGlzdC5yZW1vdmUoJ2FuaW1hdGUtb2ZmJyk7XG4gICAgICAgICAgICBuZXcgQW5pbWF0ZUZhZGUoc2VjdGlvbnNbY3VycmVudF0ucXVlcnlTZWxlY3RvcignLnNlY3Rpb25fX2NvbnRlbnQnKSwgcGxhY2UsIGlzRG93bik7XG4gICAgICAgICAgICBuZXcgU2Nyb2xsKHBsYWNlLCBpc0Rvd24sIDkwMCwgJ2NlbnRlcicpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWN0aW9uc1tjdXJyZW50XS5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLW9mZicpO1xuICAgICAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQsIGlzRG93biwgNjAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocGxhY2UuY2xhc3NMaXN0LmNvbnRhaW5zKCdhbmltYXRlLWZhZGUnKSkge1xuICAgICAgICAgIHBsYWNlLmNsYXNzTGlzdC5yZW1vdmUoJ2FuaW1hdGUtZmFkZScpO1xuICAgICAgICAgIHRhcmdldC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbl9fY29udGVudCcpLmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtZmFkZScpO1xuICAgICAgICAgIG5ldyBTY3JvbGwocGxhY2UsIGlzRG93biwgOTAwLCAnY2VudGVyJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGlzRG93bikge1xuICAgICAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQsIGlzRG93biwgNjAwKTtcbiAgICAgICAgICAgIHBsYWNlLmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtZmFkZScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgU2Nyb2xsKHNlY3Rpb25zW2N1cnJlbnRdLCBpc0Rvd24sIDYwMCk7XG4gICAgICAgICAgICBwbGFjZS5jbGFzc0xpc3QuYWRkKCdhbmltYXRlLW9mZicpO1xuICAgICAgICAgICAgc2VjdGlvbnNbY3VycmVudF0ucXVlcnlTZWxlY3RvcignLnNlY3Rpb25fX2NvbnRlbnQnKS5jbGFzc0xpc3QucmVtb3ZlKCdhbmltYXRlLWZhZGUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfSBlbHNlIGlmIChzZWN0aW9uc1tjdXJyZW50XS5jbGFzc0xpc3QuY29udGFpbnMoJ2Zvb3RlcicpICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2Zvb3RlcicpKXtcbiAgICAgICAgY29uc29sZS5sb2coJ2Zvb3RlcicpO1xuICAgICAgICBpZiAoaXNEb3duKSB7XG4gICAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQsIGlzRG93biwgNjAwLCAnYm90dG9tJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQsIGlzRG93biwgNjAwKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2codGFyZ2V0KTtcbiAgICAgICAgbmV3IFNjcm9sbCh0YXJnZXQsIGlzRG93biwgNjAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBXaGVlbCwge3Bhc3NpdmU6IGZhbHNlfSk7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXdoZWVsJywgV2hlZWwsIHtwYXNzaXZlOiBmYWxzZX0pO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NTW91c2VTY3JvbGwnLCBXaGVlbCwge3Bhc3NpdmU6IGZhbHNlfSk7XG5cbiAgbGV0IHRvdWNoWTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoZSkgPT4ge1xuICAgIHRvdWNoWSA9IGUudG91Y2hlc1swXS5zY3JlZW5ZO1xuICB9LCB7cGFzc2l2ZTogZmFsc2V9KTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIChlKSA9PiB7XG4gICAgbGV0IGRlbHRhWSA9IHRvdWNoWSAtIGUudG91Y2hlc1swXS5zY3JlZW5ZO1xuICAgIGNvbnNvbGUubG9nKGRlbHRhWSk7XG4gICAgaWYgKGRlbHRhWSA+PSA1MCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbmV3IFdoZWVsKGUsIGRlbHRhWSA+IDApO1xuICAgIH1cbiAgICBpZiAoZGVsdGFZIDw9IC01MCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbmV3IFdoZWVsKGUsIGRlbHRhWSA+IDApO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH0sIHtwYXNzaXZlOiBmYWxzZX0pO1xuXG4gIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoZSk9PntcbiAgLy8gICBsZXQgc3QgPSBkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgLy8gICBpc0Rvd24gPSBzdCAtIGxhc3RTY3JvbGxUb3AgPCAwO1xuICAvLyAgIG5ldyBXaGVlbChlLCBpc0Rvd24pO1xuICAvLyAgIGxhc3RTY3JvbGxUb3AgPSBzdDtcbiAgLy8gfSwge3Bhc3NpdmU6IGZhbHNlfSk7XG5cbiAgZnVuY3Rpb24gUGFyYWxsYXgoZSkge1xuICAgIGxldCBfdyA9IHdpbmRvdy5pbm5lcldpZHRoLzI7XG4gICAgbGV0IF9oID0gd2luZG93LmlubmVySGVpZ2h0LzI7XG4gICAgbGV0IF9tb3VzZVggPSBlLmNsaWVudFg7XG4gICAgbGV0IF9tb3VzZVkgPSBlLmNsaWVudFk7XG4gICAgbGV0IGVsZW1zID0gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKCcucGFyYWxsYXhlZCcpO1xuICAgIGVsZW1zLmZvckVhY2goKGVsLCBpbmRleCkgPT4ge1xuICAgICAgbGV0IG11bHRpcGx5ID0gaW5kZXggKiAtMC4wMDEgLSAwLjAwMTtcbiAgICAgIGVsLnN0eWxlLm1hcmdpbkxlZnQgPSBgJHsoX21vdXNlWCAtIF93KSAqIG11bHRpcGx5fSVgO1xuICAgICAgZWwuc3R5bGUubWFyZ2luVG9wID0gYCR7KF9tb3VzZVkgLSBfaCkgKiBtdWx0aXBseX0lYDtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHBhcmFsbGF4ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGFyYWxsYXgnKTtcbiAgcGFyYWxsYXhlcy5mb3JFYWNoKChwYXJhbGxheCkgPT4ge1xuICAgIHBhcmFsbGF4LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgUGFyYWxsYXgpO1xuICB9KTtcblxuICBsZXQgc3BsaWRlID0gbmV3IFNwbGlkZSggJy5yb2FkJywge1xuICAgIHBlclBhZ2U6IDMsXG4gICAgcGVyTW92ZTogMSxcbiAgICBicmVha3BvaW50czoge1xuICAgICAgOTIwOiB7XG4gICAgICAgIHBlclBhZ2U6IDJcbiAgICAgIH0sXG4gICAgICA1MjA6IHtcbiAgICAgICAgcGVyUGFnZTogMVxuICAgICAgfSxcbiAgICB9LFxuICB9ICk7XG4gIHNwbGlkZS5tb3VudCgpO1xuXG4gIGxldCBwcmVzcyA9IG5ldyBTcGxpZGUoICcuc2VjdGlvbl9fYXJ0aWNsZXMnLCB7XG4gICAgcGVyUGFnZTogMyxcbiAgICBwZXJNb3ZlOiAxLFxuICAgIGdhcDogJzMycHgnLFxuICAgIGJyZWFrcG9pbnRzOiB7XG4gICAgICA2NDA6IHtcbiAgICAgICAgZ2FwOiAnMTZweCcsXG4gICAgICAgIHBlclBhZ2U6IDJcbiAgICAgIH0sXG4gICAgICA1MjA6IHtcbiAgICAgICAgZ2FwOiAnMTZweCcsXG4gICAgICAgIHBlclBhZ2U6IDFcbiAgICAgIH0sXG4gICAgfSxcbiAgfSApO1xuICBwcmVzcy5tb3VudCgpO1xuXG4gIGxldCBzcGxpZGVPcHAgPSBuZXcgU3BsaWRlKCAnLnNlY3Rpb25fX29wcG9ydHVuaXRpZXMnLCB7XG4gICAgcGVyUGFnZTogNCxcbiAgICBwZXJNb3ZlOiAxLFxuICAgIGdhcDogJzMycHgnLFxuICAgIGJyZWFrcG9pbnRzOiB7XG4gICAgICA5MjA6IHtcbiAgICAgICAgcGVyUGFnZTogMlxuICAgICAgfSxcbiAgICAgIDY0MDoge1xuICAgICAgICBwZXJQYWdlOiAxXG4gICAgICB9XG4gICAgfSxcbiAgfSApO1xuICBzcGxpZGVPcHAubW91bnQoKTtcbn07XG5cbiJdfQ==
